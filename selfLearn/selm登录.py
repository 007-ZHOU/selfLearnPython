import requests
from  lxml import  etree
from random import choice
#线程任务的调度交给线程池来完成
import time
from concurrent.futures import ThreadPoolExecutor,ProcessPoolExecutor
from selenium import webdriver
from selenium.webdriver.chrome.options import Options#实现无可视化界面的
from selenium.webdriver import ChromeOptions#实现规避检测

def requ(url):
    headers = {
        'Upgrade-Insecure-Requests': '1',
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36 Edg/119.0.0.0',
        'sec-ch-ua': '"Microsoft Edge";v="119", "Chromium";v="119", "Not?A_Brand";v="24"',
        'sec-ch-ua-mobile': '?0',
        'sec-ch-ua-platform': '"Windows"',
    }


    proxiesHTTP=[
"46.35.9.110:80",
"204.188.255.68:4128",
"103.213.97.74:80",
"43.156.0.125:8888",
"162.248.225.127:80",
"117.160.250.134:80",
"39.107.89.178:80",
"80.99.87.3:80",
"120.82.174.128:9091",
"52.78.28.97:3888",
"162.248.225.165:80",
"117.160.250.138:8899",
"103.216.49.151:8080",
"117.160.250.133:80",
"36.88.51.210:80",
"162.248.225.144:80",
"84.39.112.144:3128",
"47.243.200.100:80",
"186.156.161.235:3128",
"8.213.151.128:3128",
"183.89.0.239:8080",
"200.71.109.105:999",
"117.160.250.133:8899",
"221.153.92.39:80",
"188.166.209.131:3128",
"222.243.201.153:9992",
"112.120.7.51:80",
"39.105.5.126:80",
"20.117.78.249:80",
"125.136.81.206:8228",
"46.101.186.238:80",
"45.119.113.65:83",
"106.14.255.124:80",
"111.38.73.92:9002",
"210.223.38.26:8080",
"103.247.23.197:8080",
"94.102.234.186:32650",
"168.196.246.118:8080",
"123.57.1.78:8499",
"132.145.50.210:3128",
"198.58.106.30:8086",
"45.189.116.48:999",
"200.174.198.120:8888",
"67.43.236.20:15331",
"20.219.137.240:3000",
"162.248.225.224:80",
"213.149.30.175:3128",
"114.156.77.107:8080",
"194.182.178.90:3128",
"67.43.236.20:21561",
"35.220.236.96:8088",
"188.87.137.45:3128",
"61.129.2.212:8080",
"149.11.36.221:8080",
"162.248.225.37:80",
"183.238.165.170:9002",
"162.248.225.8:80",
"218.252.244.126:80",
"157.245.46.100:31280",
"67.43.227.227:17113",
"123.57.1.78:1025",
"67.43.227.228:16921",
"162.248.225.16:80",
"152.32.132.220:80",
"67.43.227.227:2193",
"67.207.161.154:4128",
"136.144.155.173:3128",
"162.248.225.11:80",
"12.186.205.120:80",
"120.26.0.11:8880",
"120.27.215.236:8080",
"77.78.210.218:8080",
"131.196.14.122:999",
"162.248.225.168:80",
"195.114.209.50:80",
"34.154.161.152:80",
"117.160.250.131:80",
"177.12.118.160:80",
"122.9.4.213:80",
"162.248.225.7:80",
"43.231.64.102:8080",
"154.236.168.179:1976",
"101.255.164.134:8080",
"162.248.225.17:80",
"123.30.154.171:7777",
"162.248.225.239:80",
"185.24.42.156:1080",
"103.76.12.42:8181",
"183.230.162.122:9091",
"154.85.58.149:80",
"182.96.96.255:7890",
"5.2.180.169:8080",
"162.248.225.141:80",
"117.160.250.132:8899",
"43.198.105.38:80",
"128.199.202.122:3128",
"103.251.169.162:8080",
"103.106.217.101:8080",
"72.10.164.178:13105",
"85.10.133.96:3128",
"8.219.97.248:80",
"85.62.218.250:3128",
"190.60.36.74:8080",
"58.222.158.6:8808",
"203.95.198.112:8080",
"198.49.68.80:80",
"88.99.179.104:80",
"47.74.152.29:8888",
"162.248.225.227:80",
"109.160.22.127:8080",
"200.116.198.222:9812",
"89.37.219.210:8080",
"67.43.227.227:30435",
"162.248.225.201:80",
"223.16.92.17:80",
"47.97.21.151:1024",
"58.20.20.93:2323",
"182.92.73.106:80",
"51.68.220.201:8080",
"103.172.71.11:8080",
"67.43.236.20:24207",
"94.243.9.210:80",
"60.244.170.70:80",
"185.177.158.174:3128",
"182.74.243.47:3128",
"213.230.64.29:8080",
"120.197.40.219:9002",
"41.33.66.237:1981",
"49.7.11.187:80",
"31.148.207.153:80",
"67.43.227.227:10187",
"34.162.147.144:80",
"27.109.135.144:80",
"202.61.204.51:80",
"203.95.198.52:8080",
"47.91.104.88:3128",
"47.56.110.204:8989",
"162.248.225.34:80",
"117.160.250.132:80",
"124.167.20.48:7777",
"45.173.6.102:8080",
"194.124.36.98:8080",
"136.144.155.176:3128",
"14.103.26.53:8000",
"12.47.214.225:3128",
"162.248.225.18:80",
"51.38.70.95:8080",
"204.188.255.69:4128",
"121.183.80.210:80",
"38.156.74.101:8080",
"115.182.212.177:80",
"162.248.225.213:80",
"103.6.223.2:3128",
"103.153.154.6:80",
"45.224.249.36:8080",
"202.65.158.237:82",
"65.20.235.217:8080",
"162.248.225.159:80",
"139.198.171.113:8081",
"222.138.76.6:9002",
"117.160.250.130:8899",
"67.43.236.20:32895",
"67.43.236.19:15747",
"93.177.229.164:9812",
"162.248.225.125:80",
"123.233.245.158:9080",
"124.71.157.181:1111",
"117.160.250.130:80",
"185.103.26.78:3128",
"47.243.175.55:805",
"193.239.56.84:8081",
"49.235.127.178:8000",
"203.19.38.114:1080",
"91.241.217.58:9090",
"162.248.225.167:80",
"136.144.155.182:3128",
"117.102.212.2:1080",
"158.69.53.132:9300",
"72.10.164.178:28551",
"196.219.202.74:8080",
"144.217.180.238:8888",
"194.29.101.140:3128",
"106.105.218.244:80",
"200.90.52.218:8080",
"162.248.225.36:80",
"198.37.57.112:80",
"45.133.168.17:8080",
"202.8.74.26:8080",
"162.248.225.28:80",
"118.172.187.127:8080",
"89.145.162.81:3128",
"47.243.92.199:3128",
"204.188.255.70:4128",
"117.160.250.134:8899",
"201.148.8.12:999",
"162.248.225.108:80",
"103.156.248.103:8080",
"162.248.225.173:80",
"103.49.114.195:8080",
"102.132.201.202:80",
"45.133.168.22:8080",
"45.7.64.81:999",
"196.20.125.145:8083",
"119.13.111.169:8180",
"93.157.248.108:88",
"115.96.208.124:8080",
"162.248.225.2:80",
"183.237.222.53:9002",
"195.174.142.76:8080",
"61.7.157.51:8080",
"67.207.161.157:4128",
"47.89.184.18:3128",
"212.108.155.205:9090",
"204.188.255.66:4128",
"159.192.153.79:8080",
"47.50.101.94:8080",
"185.82.98.42:9092",
"35.220.236.96:8080",
"196.11.181.36:8080",
"152.69.211.64:9090",
"64.225.8.132:10001",
"185.249.107.84:3128",
"103.247.82.2:8080",
"103.231.249.242:3128",
"217.12.21.249:80",
"5.161.180.12:3128",
"189.240.60.168:9090",
"114.231.46.20:8089",
"102.132.56.218:8080",
"31.186.136.15:3128",
"27.79.199.186:3128",
"163.53.82.237:32650",
"38.156.238.181:999",
"117.187.18.136:3128",
"119.6.239.22:80",
"45.133.168.120:8080",
"91.235.220.122:80",
"180.242.248.99:8080",
"102.216.181.6:8080",
"132.145.162.109:3128",
"95.164.84.68:3128",
"103.23.37.138:80",
"92.114.19.131:3128",
"92.114.19.138:3128",
"5.180.254.9:80",
"196.11.183.216:8080",
"103.105.196.130:3128",
"186.13.11.121:8080",
"23.131.56.171:999",
"85.214.251.15:3128",
"5.161.111.42:3128",
"103.156.17.151:8080",
"103.231.78.36:80",
"185.221.237.219:80",
"163.53.82.238:32650",
"103.178.94.107:80",
"103.147.241.3:8181",
"31.210.172.11:3128",
"143.47.121.145:3128",
"177.200.239.46:999",
"38.7.197.192:999",
"109.254.81.159:9090",
"196.251.135.157:8080",
"102.132.40.222:8080",
"190.94.239.182:8080",
"102.132.41.31:8080",
"216.238.99.171:80",
"122.116.150.2:9000",
"177.200.239.40:999",
"95.216.164.36:80",
"170.187.226.142:3128",
"94.130.54.171:7449",
"94.130.54.171:7455",
"94.130.54.171:7396",
"194.182.187.78:3128",
"188.215.245.235:80",
"94.130.54.171:7293",
"94.130.54.171:7095",
"190.110.35.224:999",
"103.118.175.87:1645",
"179.1.129.37:999",
"14.161.24.81:2022",
"142.93.218.24:3128",
"58.250.250.115:8888",
"121.230.210.254:8089",
"114.106.135.0:8089",
"65.21.232.59:8786",
"223.247.46.96:8089",
"119.110.73.226:3888",
"5.161.82.73:3128",
"179.53.239.155:3128",
"41.77.210.210:80",
"69.70.244.34:80",
"45.71.169.145:80",
"103.83.232.122:80",
"179.1.85.210:999",
"222.190.173.154:8089",
"103.218.188.2:80",
"114.231.46.185:8089",
"88.99.249.96:8283",
"115.127.88.138:8674",
"200.125.168.132:999",
"88.99.249.96:8177",
"129.213.118.148:3128",
"180.119.92.64:8089",
"117.94.122.150:9000",
"5.165.6.188:1513",
"114.233.70.184:9000",
"103.167.71.38:8080",
"188.136.154.52:7060",
"221.230.216.50:7788",
"103.162.199.41:8080",
"123.245.248.135:8089",
"138.117.77.214:999",
"179.53.250.19:3128",
"92.63.168.248:80",
"128.199.202.122:8080",
"5.161.207.168:3128",
"114.103.81.34:8089",
"101.34.30.200:8081",
"114.233.70.213:9000",
"45.5.118.43:999",
"110.34.3.229:3128",
"2.83.198.171:80",
"103.139.144.105:8080",
"103.150.18.218:80",
"192.141.196.129:8080",
"78.47.186.43:6666",
"45.189.113.142:999",
"103.137.198.5:8080",
"222.190.208.125:8089",
"221.230.216.54:7788",
"201.77.108.149:999",
"162.212.157.35:8080",
"115.127.122.100:8080",
"118.70.12.171:53281",
"190.90.8.74:8080",
"85.50.139.97:55443",
"103.48.68.36:82",
"41.65.236.57:1976",
"162.212.157.238:8080",
"162.212.153.95:8080",
"45.224.119.184:999",
"200.7.10.158:8080",
"43.133.180.107:7890",
"103.159.46.34:84",
"41.65.236.53:1981",
"190.217.101.73:999",
"94.231.178.249:9797",
"186.101.84.214:999",
"103.127.1.130:80",
"223.215.177.196:8089",
"63.42.112.155:8001",
"114.233.71.0:9000",
"34.86.252.79:8585",
"34.162.24.17:8585",
"34.86.196.77:8585",
"34.162.183.32:8585",
"34.162.76.11:8585",
"35.193.158.6:8585",
"34.162.59.88:8585",
"114.231.8.204:8089",
"34.162.63.141:8585",
"34.162.67.130:8585",
"183.165.246.108:8089",
"34.162.171.228:8585",
"223.247.46.169:8089",
"34.86.138.63:8585",
"34.162.135.2:8585",
"34.162.156.215:8585",
"34.85.155.119:8585",
"34.162.53.144:8585",
"34.162.22.200:8585",
"35.245.31.182:8585",
"102.68.128.217:8080",
"66.29.154.103:3128",
"49.70.89.246:8089",
"46.160.209.155:8088",
"187.62.64.155:45005",
"87.123.56.163:80",
"181.225.107.227:999",
"200.82.188.28:999",
"103.146.17.241:80",
"222.190.208.233:8089",
"114.103.88.53:8089",
"117.70.48.40:8089",
"103.169.53.87:8080",
"45.225.185.62:999",
"198.44.191.202:45787",
"177.66.101.223:8024",
"45.184.155.3:999",
"123.245.248.97:8089",
"41.215.85.74:8080",
"182.204.183.221:8089",
"179.63.149.5:999",
"123.245.250.179:8089",
"123.245.249.5:8089",
"43.251.118.153:45787",
"102.68.128.214:8080",
"37.32.12.216:4006",
"123.245.250.190:8089",
"182.204.176.86:8089",
"114.106.134.117:8089",
"114.103.88.87:8089",
"158.101.113.18:80",
"65.20.171.253:8080",
"221.230.216.200:7788",
"114.106.173.101:8089",
"188.127.249.9:20255",
"103.68.194.85:45787",
"222.190.173.102:8089",
"223.215.177.115:8089",
"103.80.54.132:32650",
"183.165.248.179:8089",
"197.243.67.110:80",
"114.233.70.173:9000",
"123.245.250.6:8089",
"165.225.206.248:10007",
"182.204.178.100:8089",
"186.167.24.66:999",
"182.204.181.134:8089",
"102.69.236.152:80",
"117.94.121.29:9000",
"114.231.41.171:8089",
"183.165.244.37:8089",
"120.35.200.44:8089",
"174.138.184.82:38661",
"117.94.122.175:9000",
"180.175.124.102:8118",
"158.140.191.136:8080",
"114.106.173.122:8089",
"188.235.0.207:8282",
"103.118.78.194:80",
"223.215.176.37:8089",
"95.217.210.191:8080",
"123.245.249.185:8089",

        
    ],

    proxiesHTTPS=[
    '103.165.125.182:8080',
    '181.192.2.23:8080',
    '212.227.184.59:8080',
    '188.0.138.224:8080',
    '202.137.8.150:8080',
    '165.0.136.30:8080',
    '46.175.1.65:8080',
    '187.188.167.108:8080'
    ]


    response = requests.get(
        url=url,
        # params=params,
        headers=headers,
        proxies={'http': choice(proxiesHTTP),'https':choice(proxiesHTTPS)}  # Use the first proxy in the list
    )


    tree =etree.HTML(text=response.text)
    type=tree.xpath('//*[@id="container"]/div[2]/div[1]/div[1]/div[6]/div/div/div[2]/div[7]/div[2]/span/text()')
    print(type)
    import random
 
    random_number = random.randint(10, 50)
    time.sleep(random_number)
    response.close()

    """options=webdriver.ChromeOptions()
    options.add_argument('--proxy-server='+choice(proxiesHTTP))
    
    options.add_argument(
            'user-agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36"')
    
    options.add_argument('--headless')
    options.add_argument('--disable-gpu')
    #如何实现让selenium规避被检测到的风险
    # option=ChromeOptions()
    options.add_experimental_option('excludeSwithes',['enable-automation'])

    driver = webdriver.Chrome(options=options)
    # driver.maximize_window()
    driver.get(url)
    print(driver.name)
    time.sleep(3)
    driver.close()"""


#任务
def fn(url):
    for i in range(1000):
        print(url)
        requ(url)
        # print(name,i)


if __name__ == '__main__':
    #创建线程池 

    urls = [
            'https://www.alibaba.com/product-detail/Design-Home-Light-Luxury-Furniture-Sofa_1600992749835.html',
            'https://www.alibaba.com/product-detail/Simple-Modern-Design-Living-Room-Sofa_1600992771942.html',
            'https://www.alibaba.com/product-detail/Modern-Sectional-Corner-Couch-Sofa-Set_1600992872124.html',
    ]
    with  ThreadPoolExecutor(50) as t:#创建了一个有10个线程组成的线程池
        for i in range(500):#300个任务
            url=choice(urls)
            t.submit(fn,url=url)